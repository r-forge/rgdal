<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Methods for Function spTransform for map projection and datum transformation in package "rgdal" — spTransform-methods • rgdal</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Methods for Function spTransform for map projection and datum transformation in package " rgdal sptransform-methods><meta property="og:description" content='The spTransform methods provide transformation between datum(s) and conversion between projections (also known as projection and/or re-projection), from one unambiguously specified coordinate reference system (CRS) to another, prior to version 1.5 using Proj4 projection arguments. From version 1.5, Well-Known Text 2 (WKT2 2019) strings are used. For simple projection, when no Proj4 +datum tags are used, datum projection does not occur. When datum transformation is required, the datum should be defined with a valid value both in the CRS of the object to be transformed, and in the target CRS. In general datum is to be prefered to ellipsoid, because the datum always fixes the ellipsoid, but the ellipsoid never fixes the datum.
In addition, before version 1.5 the +towgs84 tag should have been used where needed to make sure that datum transformation would take place. Parameters for +towgs84 were taken from the legacy bundled EPSG file if they are known unequivocally, but could be entered manually from known authorities. Not providing the appropriate +datum and +towgs84 tags led to coordinates being out by hundreds of metres. Unfortunately, there is no easy way to provide this information: the user has to know the correct metadata for the data being used, even if this can be hard to discover.
From version 1.5, spTransform uses the modern PROJ coordinate operation framework for transformations. This avoids pivoting through WGS84 if possible, and uses WKT2 (2019) strings for source and target CRS often constructed from the bundled EPSG SQLite database. The database is searched for feasible candidate coordinate operations, and the most accurate available is chosen. More details are available in a vignette: vignette("CRS_projections_transformations").'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rgdal</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6-4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/CRS_projections_transformations.html">Why have CRS, projections and transformations changed?</a>
    </li>
    <li>
      <a href="../articles/PROJ6_GDAL3.html">Migration to PROJ6/GDAL3</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Methods for Function spTransform for map projection and datum transformation in package "rgdal"</h1>
    
    <div class="hidden name"><code>spTransform-methods.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>spTransform</code> methods provide transformation between datum(s) and conversion between projections (also known as projection and/or re-projection), from one unambiguously specified coordinate reference system (CRS) to another, prior to version 1.5 using Proj4 projection arguments. From version 1.5, Well-Known Text 2 (WKT2 2019) strings are used. For simple projection, when no Proj4 +datum tags are used, datum projection does not occur. When datum transformation is required, the datum should be defined with a valid value both in the CRS of the object to be transformed, and in the target CRS. In general datum is to be prefered to ellipsoid, because the datum always fixes the ellipsoid, but the ellipsoid never fixes the datum.</p>
<p>In addition, before version 1.5 the +towgs84 tag should have been used where needed to make sure that datum transformation would take place. Parameters for +towgs84 were taken from the legacy bundled EPSG file if they are known unequivocally, but could be entered manually from known authorities. Not providing the appropriate +datum and +towgs84 tags led to coordinates being out by hundreds of metres. Unfortunately, there is no easy way to provide this information: the user has to know the correct metadata for the data being used, even if this can be hard to discover.</p>
<p>From version 1.5, <code>spTransform</code> uses the modern PROJ coordinate operation framework for transformations. This avoids pivoting through WGS84 if possible, and uses WKT2 (2019) strings for source and target CRS often constructed from the bundled EPSG SQLite database. The database is searched for feasible candidate coordinate operations, and the most accurate available is chosen. More details are available in a vignette: <code><a href="../articles/CRS_projections_transformations.html">vignette("CRS_projections_transformations")</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_transform_wkt_comment</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">set_transform_wkt_comment</span><span class="op">(</span><span class="va">value</span><span class="op">)</span></span>
<span><span class="fu">get_enforce_xy</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">set_enforce_xy</span><span class="op">(</span><span class="va">value</span><span class="op">)</span></span>
<span><span class="fu">get_last_coordOp</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="methods">
    <h2>Methods</h2>
    <dl><dt>"ANY"</dt>
<dd><p>default void method</p></dd>


<dt>"SpatialPoints", CRSobj = CRS</dt>
<dd><p>returns transformed coordinates of an "SpatialPoints" object using the projection arguments in "CRSobj", of class CRS</p></dd>


<dt>"SpatialPointsDataFrame", CRSobj = CRS</dt>
<dd><p>returns transformed coordinates of an "SpatialPointsDataFrame" object using the projection arguments in "CRSobj", of class CRS</p></dd>


<dt>"SpatialLines", CRSobj = CRS</dt>
<dd><p>returns transformed coordinates of an "SpatialLines" object using the projection arguments in "CRSobj", of class CRS</p></dd>


<dt>"SpatialLinesDataFrame", CRSobj = CRS</dt>
<dd><p>returns transformed coordinates of an "SpatialLinesDataFrame" object using the projection arguments in "CRSobj", of class CRS</p></dd>


<dt>"SpatialPolygons", CRSobj = CRS</dt>
<dd><p>returns transformed coordinates of an "SpatialPolygons" object using the projection arguments in "CRSobj", of class CRS</p></dd>


<dt>"SpatialPolygonsDataFrame", CRSobj = CRS</dt>
<dd><p>returns transformed coordinates of an "SpatialPolygonsDataFrame" object using the projection arguments in "CRSobj", of class CRS</p></dd>

<dt>"SpatialPixelsDataFrame", CRSobj = CRS</dt>
<dd><p>Because regular grids will usually not be regular after projection/datum transformation, the input object is coerced to a SpatialPointsDataFrame, and the transformation carried out on that object. A warning: “Grid warping not available, coercing to points” is given.</p></dd>

<dt>"SpatialGridDataFrame", CRSobj = CRS</dt>
<dd><p>Because regular grids will usually not be regular after projection/datum transformation, the input object is coerced to a SpatialPointsDataFrame, and the transformation carried out on that object. A warning: “Grid warping not available, coercing to points” is given.</p></dd>



</dl></div>
    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>value</dt>
<dd><p>A non-NA logical value</p></dd>

</dl></div>
    <div id="note">
    <h2>Note</h2>
    <p>The projection arguments had to be entered exactly as in the PROJ.4 documentation, in particular there cannot be any white space in +&lt;arg&gt;=&lt;value&gt; strings, and successive such strings can only be separated by blanks.
Note that warnings about different projections may be issued when the PROJ.4 library extends projection arguments; examine the warning to see if the differences are real.</p>
<p>Also note that re-projection and/or datum transformation will usually not work for regular grids. The term used for similar operations for regular grids is warping, which involved resampling to a regular grid in the target coordinate reference system.</p>
<p>The methods may take an optional argument “use_ob_tran”, default FALSE, if TRUE and “+proj=ob_tran”, use General Oblique Transformation with internalised from/to projection reversal (the user oblique transforms from longlat to oblique forward rather than inverse as suggested in PROJ.4 mailing list postings); these changes are intended to meet a need pointed out by Martin Ivanov (2012-08-15). A subsequent point raised by Martin Ivanov (2017-04-28) was that use of a projected CRS with “+proj=ob_tran” led to errors, so mixing projected CRS and “+proj=ob_tran” is blocked. Transform first “+proj=ob_tran” to or from “+proj=longlat”, and then on from geographical coordinates to those desired or the reverse - see example.</p>
<p>If a SpatialPoints object has three dimensions, the third will also be transformed, with the metric of the third dimension assumed to be meters if the vertical units metric is not given in the projection description with +vunits= or +vto_meter= (which is 1.0 by default) <a href="https://proj.org/faq.html" class="external-link">https://proj.org/faq.html</a>.</p>
<p>Note that WGS84 is both an ellipse and a datum, and that since 1984 there have been changes in the relative positions of continents, leading to a number of modifications. This is discussed for example in <a href="https://www.uvm.edu/giv/resources/WGS84_NAD83.pdf" class="external-link">https://www.uvm.edu/giv/resources/WGS84_NAD83.pdf</a>; there are then multiple transformations between NAD83 and WGS84 depending on the WGS84 definition used. One would expect that “+towgs84=” is a no-op for WGS84, but this only applies sometimes, and as there are now at least 30 years between now and 1984, things have shifted. It may be useful to note that “+nadgrids=@null” can help, see these threads: <a href="https://stat.ethz.ch/pipermail/r-sig-geo/2014-August/021611.html" class="external-link">https://stat.ethz.ch/pipermail/r-sig-geo/2014-August/021611.html</a>, <a href="http://lists.maptools.org/pipermail/proj/2014-August/006894.html" class="external-link">http://lists.maptools.org/pipermail/proj/2014-August/006894.html</a>, with thanks to Hermann Peifer for assistance.</p>
<p>Note that from PROJ.4 4.9.3, the definition of UTM is changed from TMERC to ETMERC; see example.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Roger Bivand <a href="mailto:Roger.Bivand@nhh.no">Roger.Bivand@nhh.no</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="showWKT.html">set_thin_PROJ6_warnings</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># state</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">state.x77</span>, <span class="va">state.center</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="va">states</span><span class="op">[</span><span class="va">states</span><span class="op">$</span><span class="va">x</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">121</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">states</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/is.projected.html" class="external-link">proj4string</a></span><span class="op">(</span><span class="va">states</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +ellps=clrk66"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">states</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class SpatialPointsDataFrame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         min      max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x -120.0680 -68.9801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y   27.8744  47.4231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Is projected: FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> proj4string : [+proj=longlat +ellps=clrk66 +no_defs]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of points: 48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data attributes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Population        Income       Illiteracy       Life.Exp    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   :  376   Min.   :3098   Min.   :0.500   Min.   :67.96  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.: 1188   1st Qu.:3964   1st Qu.:0.600   1st Qu.:70.13  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 2980   Median :4488   Median :0.900   Median :70.67  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 4398   Mean   :4386   Mean   :1.148   Mean   :70.85  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.: 5064   3rd Qu.:4768   3rd Qu.:1.450   3rd Qu.:71.88  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :21198   Max.   :5348   Max.   :2.800   Max.   :72.96  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Murder          HS.Grad          Frost             Area       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   : 1.400   Min.   :37.80   Min.   : 11.00   Min.   :  1049  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.: 4.275   1st Qu.:47.70   1st Qu.: 68.75   1st Qu.: 38762  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 6.850   Median :53.05   Median :114.50   Median : 54277  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 7.321   Mean   :52.64   Mean   :105.65   Mean   : 61749  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.:10.625   3rd Qu.:58.62   3rd Qu.:139.25   3rd Qu.: 79914  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :15.100   Max.   :67.30   Max.   :188.00   Max.   :262134  </span>
<span class="r-in"><span><span class="va">state.ll83</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">states</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +ellps=GRS80"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">state.ll83</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class SpatialPointsDataFrame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         min      max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x -120.0680 -68.9801</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y   27.8744  47.4231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Is projected: FALSE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> proj4string : [+proj=longlat +ellps=GRS80 +no_defs]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of points: 48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data attributes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Population        Income       Illiteracy       Life.Exp    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   :  376   Min.   :3098   Min.   :0.500   Min.   :67.96  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.: 1188   1st Qu.:3964   1st Qu.:0.600   1st Qu.:70.13  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 2980   Median :4488   Median :0.900   Median :70.67  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 4398   Mean   :4386   Mean   :1.148   Mean   :70.85  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.: 5064   3rd Qu.:4768   3rd Qu.:1.450   3rd Qu.:71.88  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :21198   Max.   :5348   Max.   :2.800   Max.   :72.96  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Murder          HS.Grad          Frost             Area       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   : 1.400   Min.   :37.80   Min.   : 11.00   Min.   :  1049  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.: 4.275   1st Qu.:47.70   1st Qu.: 68.75   1st Qu.: 38762  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 6.850   Median :53.05   Median :114.50   Median : 54277  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 7.321   Mean   :52.64   Mean   :105.65   Mean   : 61749  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.:10.625   3rd Qu.:58.62   3rd Qu.:139.25   3rd Qu.: 79914  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :15.100   Max.   :67.30   Max.   :188.00   Max.   :262134  </span>
<span class="r-in"><span><span class="va">state.merc</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">states</span>, CRS<span class="op">=</span><span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=merc +ellps=GRS80"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">state.merc</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class SpatialPointsDataFrame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         min      max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x -13365909 -7678830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y   3213175  5979931</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Is projected: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> proj4string :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=GRS80 +units=m +no_defs]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of points: 48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data attributes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Population        Income       Illiteracy       Life.Exp    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   :  376   Min.   :3098   Min.   :0.500   Min.   :67.96  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.: 1188   1st Qu.:3964   1st Qu.:0.600   1st Qu.:70.13  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 2980   Median :4488   Median :0.900   Median :70.67  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 4398   Mean   :4386   Mean   :1.148   Mean   :70.85  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.: 5064   3rd Qu.:4768   3rd Qu.:1.450   3rd Qu.:71.88  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :21198   Max.   :5348   Max.   :2.800   Max.   :72.96  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Murder          HS.Grad          Frost             Area       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   : 1.400   Min.   :37.80   Min.   : 11.00   Min.   :  1049  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.: 4.275   1st Qu.:47.70   1st Qu.: 68.75   1st Qu.: 38762  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 6.850   Median :53.05   Median :114.50   Median : 54277  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 7.321   Mean   :52.64   Mean   :105.65   Mean   : 61749  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.:10.625   3rd Qu.:58.62   3rd Qu.:139.25   3rd Qu.: 79914  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :15.100   Max.   :67.30   Max.   :188.00   Max.   :262134  </span>
<span class="r-in"><span><span class="va">state.merc</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">states</span>,</span></span>
<span class="r-in"><span> CRS<span class="op">=</span><span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=merc +ellps=GRS80 +units=us-mi"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">state.merc</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class SpatialPointsDataFrame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         min       max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x -8305.174 -4771.394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  1996.571  3715.749</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Is projected: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> proj4string :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [+proj=merc +lon_0=0 +k=1 +x_0=0 +y_0=0 +ellps=GRS80 +units=us-mi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +no_defs]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of points: 48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data attributes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Population        Income       Illiteracy       Life.Exp    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   :  376   Min.   :3098   Min.   :0.500   Min.   :67.96  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.: 1188   1st Qu.:3964   1st Qu.:0.600   1st Qu.:70.13  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 2980   Median :4488   Median :0.900   Median :70.67  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 4398   Mean   :4386   Mean   :1.148   Mean   :70.85  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.: 5064   3rd Qu.:4768   3rd Qu.:1.450   3rd Qu.:71.88  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :21198   Max.   :5348   Max.   :2.800   Max.   :72.96  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Murder          HS.Grad          Frost             Area       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   : 1.400   Min.   :37.80   Min.   : 11.00   Min.   :  1049  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.: 4.275   1st Qu.:47.70   1st Qu.: 68.75   1st Qu.: 38762  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 6.850   Median :53.05   Median :114.50   Median : 54277  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 7.321   Mean   :52.64   Mean   :105.65   Mean   : 61749  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.:10.625   3rd Qu.:58.62   3rd Qu.:139.25   3rd Qu.: 79914  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :15.100   Max.   :67.30   Max.   :188.00   Max.   :262134  </span>
<span class="r-in"><span><span class="co"># NAD</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="projInfo.html">PROJis6ormore</a></span><span class="op">(</span><span class="op">)</span> <span class="op">||</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="projInfo.html">PROJis6ormore</a></span><span class="op">(</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="projInfo.html">projNAD</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">state.x77</span>, <span class="va">state.center</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">states</span> <span class="op">&lt;-</span> <span class="va">states</span><span class="op">[</span><span class="va">states</span><span class="op">$</span><span class="va">x</span> <span class="op">&gt;</span> <span class="op">-</span><span class="fl">121</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">states</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/is.projected.html" class="external-link">proj4string</a></span><span class="op">(</span><span class="va">states</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:4267"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">states</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">state.ll83</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">states</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:4269"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">state.ll83</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">state.kansasSlcc</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">states</span>, CRS<span class="op">=</span><span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:26978"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">state.kansasSlcc</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SFpoint_NAD83</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPoints</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">103.869667</span>, <span class="fl">44.461676</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> proj4string<span class="op">=</span><span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:4269"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SFpoint_NAD27</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">SFpoint_NAD83</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:4267"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">SFpoint_NAD83</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">SFpoint_NAD27</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">SFpoint_NAD27</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">SFpoint_NAD83</span><span class="op">)</span>, digits<span class="op">=</span><span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/is.projected.html" class="external-link">proj4string</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:28992"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># see http://trac.osgeo.org/gdal/ticket/1987</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class SpatialPointsDataFrame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      min    max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x 178605 181390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y 329714 333611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Is projected: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> proj4string :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [+proj=sterea +lat_0=52.1561605555556 +lon_0=5.38763888888889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +k=0.9999079 +x_0=155000 +y_0=463000 +ellps=bessel +units=m +no_defs]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of points: 155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data attributes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cadmium           copper            lead            zinc       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   : 0.200   Min.   : 14.00   Min.   : 37.0   Min.   : 113.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.: 0.800   1st Qu.: 23.00   1st Qu.: 72.5   1st Qu.: 198.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 2.100   Median : 31.00   Median :123.0   Median : 326.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 3.246   Mean   : 40.32   Mean   :153.4   Mean   : 469.7  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.: 3.850   3rd Qu.: 49.50   3rd Qu.:207.0   3rd Qu.: 674.5  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :18.100   Max.   :128.00   Max.   :654.0   Max.   :1839.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       elev             dist               om         ffreq  soil   lime   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   : 5.180   Min.   :0.00000   Min.   : 1.000   1:84   1:97   0:111  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.: 7.546   1st Qu.:0.07569   1st Qu.: 5.300   2:48   2:46   1: 44  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 8.180   Median :0.21184   Median : 6.900   3:23   3:12          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 8.165   Mean   :0.24002   Mean   : 7.478                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.: 8.955   3rd Qu.:0.36407   3rd Qu.: 9.000                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :10.520   Max.   :0.88039   Max.   :17.000                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                     NA's   :2                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     landuse       dist.m      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  W      :50   Min.   :  10.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Ah     :39   1st Qu.:  80.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Am     :22   Median : 270.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Fw     :10   Mean   : 290.3  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Ab     : 8   3rd Qu.: 450.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (Other):25   Max.   :1000.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NA's   : 1                   </span>
<span class="r-in"><span><span class="va">meuse.utm</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">meuse</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=utm +zone=32 +datum=WGS84"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>PROJ support is provided by the sf and terra packages among others</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">meuse.utm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Object of class SpatialPointsDataFrame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         min       max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x  269909.9  272832.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y 5650085.3 5653888.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Is projected: TRUE </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> proj4string :</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [+proj=utm +zone=32 +datum=WGS84 +units=m +no_defs]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of points: 155</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data attributes:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     cadmium           copper            lead            zinc       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   : 0.200   Min.   : 14.00   Min.   : 37.0   Min.   : 113.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.: 0.800   1st Qu.: 23.00   1st Qu.: 72.5   1st Qu.: 198.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 2.100   Median : 31.00   Median :123.0   Median : 326.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 3.246   Mean   : 40.32   Mean   :153.4   Mean   : 469.7  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.: 3.850   3rd Qu.: 49.50   3rd Qu.:207.0   3rd Qu.: 674.5  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :18.100   Max.   :128.00   Max.   :654.0   Max.   :1839.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       elev             dist               om         ffreq  soil   lime   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Min.   : 5.180   Min.   :0.00000   Min.   : 1.000   1:84   1:97   0:111  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1st Qu.: 7.546   1st Qu.:0.07569   1st Qu.: 5.300   2:48   2:46   1: 44  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Median : 8.180   Median :0.21184   Median : 6.900   3:23   3:12          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Mean   : 8.165   Mean   :0.24002   Mean   : 7.478                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3rd Qu.: 8.955   3rd Qu.:0.36407   3rd Qu.: 9.000                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Max.   :10.520   Max.   :0.88039   Max.   :17.000                        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                     NA's   :2                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     landuse       dist.m      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  W      :50   Min.   :  10.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Ah     :39   1st Qu.:  80.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Am     :22   Median : 270.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Fw     :10   Mean   : 290.3  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Ab     : 8   3rd Qu.: 450.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (Other):25   Max.   :1000.0  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  NA's   : 1                   </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">meuse</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">meuse.utm</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          x      y        x       y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   181072 333611 272531.7 5653889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   181025 333558 272482.1 5653838</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   181165 333537 272620.9 5653810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   181298 333484 272751.2 5653751</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   181307 333330 272752.7 5653597</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   181390 333260 272832.1 5653523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   181165 333370 272612.8 5653644</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   181027 333363 272474.5 5653643</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   181060 333231 272501.0 5653510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  181232 333168 272669.8 5653438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  181191 333115 272626.2 5653388</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  181032 333031 272463.3 5653311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  180874 333339 272320.5 5653627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  180969 333252 272411.2 5653535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  181011 333161 272448.7 5653442</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16  180830 333246 272272.0 5653536</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17  180763 333104 272198.1 5653398</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18  180694 332972 272122.7 5653269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19  180625 332847 272047.6 5653148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20  180555 332707 271970.8 5653011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21  180642 332708 272057.8 5653008</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22  180704 332717 272120.2 5653014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23  180704 332664 272117.6 5652961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24  181153 332925 272578.9 5653200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25  181147 332823 272567.9 5653098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26  181167 332778 272585.7 5653052</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27  181008 332777 272426.8 5653059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 28  180973 332687 272387.4 5652971</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 29  180916 332753 272333.7 5653039</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 30  181352 332946 272778.8 5653211</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 31  181133 332570 272541.5 5652846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 32  180878 332489 272282.8 5652777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 33  180829 332450 272232.0 5652741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 34  180954 332399 272354.3 5652684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 35  180956 332318 272352.4 5652603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 37  180710 332330 272107.2 5652627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 38  180632 332445 272034.9 5652746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 39  180530 332538 271937.6 5652843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 40  180478 332578 271887.6 5652886</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 41  180383 332476 271787.7 5652789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  180494 332330 271891.4 5652637</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 43  180561 332193 271951.6 5652497</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 44  180451 332175 271840.8 5652485</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 45  180410 332031 271792.8 5652343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 46  180355 332299 271751.0 5652613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 47  180292 332157 271681.1 5652475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 48  180283 332014 271665.1 5652332</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 49  180282 331861 271656.6 5652179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 50  180270 331707 271637.1 5652026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 51  180199 331591 271560.5 5651914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 52  180135 331552 271494.6 5651878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 53  180237 332351 271635.7 5652671</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 54  180103 332297 271499.2 5652624</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 55  179973 332255 271367.2 5652588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 56  179826 332217 271218.5 5652557</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 57  179687 332161 271076.9 5652508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 58  179792 332035 271175.6 5652377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 59  179902 332113 271289.3 5652450</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 60  180100 332213 271492.1 5652540</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 61  179604 332059 270989.0 5652410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 62  179526 331936 270905.0 5652291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 63  179495 331770 270865.9 5652127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 64  179489 331633 270853.2 5651990</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 65  179414 331494 270771.5 5651855</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 66  179334 331366 270685.3 5651731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 67  179255 331264 270601.3 5651633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 69  179470 331125 270809.3 5651484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 75  179692 330933 271021.7 5651281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 76  179852 330801 271175.1 5651141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 79  179140 330955 270471.3 5651330</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 80  179128 330867 270455.0 5651243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 81  179065 330864 270391.9 5651243</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 82  179007 330727 270327.3 5651109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 83  179110 330758 270431.7 5651135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 84  179032 330645 270348.2 5651026</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 85  179095 330636 270410.7 5651014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 86  179058 330510 270367.6 5650890</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 87  178810 330666 270127.5 5651058</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 88  178912 330779 270234.9 5651166</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 89  178981 330924 270310.9 5651307</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90  179076 331005 270409.8 5651383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 123 180151 330353 271451.8 5650679</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 160 179211 331175 270553.0 5651547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 163 181118 333214 272558.1 5653490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 70  179474 331304 270822.1 5651662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 71  179559 331423 270912.8 5651777</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 91  179022 330873 270349.4 5651254</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 92  178953 330742 270274.0 5651127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 93  178875 330516 270185.0 5650905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 94  178803 330349 270104.9 5650741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95  179029 330394 270332.9 5650775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 96  178605 330406 269909.9 5650808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 97  178701 330557 270013.2 5650954</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 98  179547 330245 270843.1 5650601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 99  179301 330179 270594.1 5650547</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 100 179405 330567 270717.0 5650930</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 101 179462 330766 270783.7 5651126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 102 179293 330797 270616.4 5651165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 103 179180 330710 270499.3 5651083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 104 179206 330398 270509.9 5650771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 105 179618 330458 270924.5 5650810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 106 179782 330540 271092.3 5650884</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 108 179980 330773 271301.6 5651107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 109 180067 331185 271408.7 5651515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 110 180162 331387 271513.5 5651712</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 111 180451 331473 271806.4 5651783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 112 180328 331158 271668.1 5651475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 113 180276 330963 271606.6 5651283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 114 180114 330803 271436.9 5651131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 115 179881 330912 271209.5 5651251</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 116 179774 330921 271103.0 5651265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 117 179657 331150 270997.4 5651500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 118 179731 331245 271075.9 5651591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 179717 331441 271071.6 5651787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 120 179446 331422 270799.9 5651782</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 121 179524 331565 270884.8 5651921</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 122 179644 331730 271012.8 5652080</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 124 180321 330366 271622.3 5650684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 125 180162 331837 271535.6 5652161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 126 180029 331720 271396.9 5652051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 127 179797 331919 271174.9 5652261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 128 179642 331955 271021.9 5652305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 129 179849 332142 271237.8 5652481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 130 180265 332297 271661.0 5652616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 131 180107 332101 271493.6 5652428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 132 180462 331947 271840.7 5652256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 133 180478 331822 271850.5 5652131</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 134 180347 331700 271713.7 5652015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 135 180862 333116 272297.6 5653405</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 136 180700 332882 272124.3 5653179</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 161 180201 331160 271541.3 5651483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 162 180173 331923 271550.8 5652247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 137 180923 332874 272346.7 5653160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 138 180467 331694 271833.2 5652003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 140 179917 331325 271265.7 5651662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 141 179822 331242 271166.7 5651583</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 142 179991 331069 271327.1 5651402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 143 179120 330578 270432.8 5650955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 144 179034 330561 270346.1 5650942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 145 179085 330433 270390.8 5650811</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 146 179236 330046 270522.6 5650417</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 147 179456 330072 270743.7 5650433</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 148 179550 329940 270831.1 5650296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 149 179445 329807 270719.7 5650168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 150 179337 329870 270614.9 5650237</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 151 179245 329714 270515.4 5650085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 152 179024 329733 270295.5 5650115</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 153 178786 329822 270062.1 5650216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 154 179135 329890 270414.1 5650267</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 155 179030 330082 270318.6 5650463</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 156 179184 330182 270477.4 5650556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 157 179085 330292 270383.9 5650671</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 158 178875 330311 270175.0 5650700</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 159 179466 330381 270768.8 5650741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 164 180627 330190 271919.3 5650493</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Kiritimati</span></span></span>
<span class="r-in"><span><span class="va">kiritimati_primary_roads</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgdal-deprecated.html">readOGR</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"vectors"</span>,</span></span>
<span class="r-in"><span> package <span class="op">=</span> <span class="st">"rgdal"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"kiritimati_primary_roads"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">kiritimati_primary_roads_ll</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">kiritimati_primary_roads</span>,</span></span>
<span class="r-in"><span> <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +datum=WGS84"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kiritimati_primary_roads</span>, axes<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kiritimati_primary_roads_ll</span>, axes<span class="op">=</span><span class="cn">TRUE</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># scot_BNG</span></span></span>
<span class="r-in"><span><span class="va">scot_BNG</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgdal-deprecated.html">readOGR</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"vectors"</span>, package <span class="op">=</span> <span class="st">"rgdal"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>   <span class="st">"scot_BNG"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scot_LL</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">scot_BNG</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +datum=WGS84"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scot_LL</span>, axes<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">grdtxt_LL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/gridlines.html" class="external-link">gridat</a></span><span class="op">(</span><span class="va">scot_LL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">grd_LL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/gridlines.html" class="external-link">gridlines</a></span><span class="op">(</span><span class="va">scot_LL</span>, ndiscr<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">grd_LL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">target</span> <span class="op">&lt;-</span> <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/is.projected.html" class="external-link">proj4string</a></span><span class="op">(</span><span class="va">scot_BNG</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">grd_BNG</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">grd_LL</span>, <span class="va">target</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">grdtxt_BNG</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">grdtxt_LL</span>, <span class="va">target</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">opar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scot_BNG</span>, axes<span class="op">=</span><span class="cn">TRUE</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">grd_BNG</span>, add<span class="op">=</span><span class="cn">TRUE</span>, lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">grdtxt_BNG</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">parse</a></span><span class="op">(</span>text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">grdtxt_BNG</span><span class="op">$</span><span class="va">labels</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">opar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># broke_proj</span></span></span>
<span class="r-in"><span><span class="va">broke_proj</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="co"># https://github.com/OSGeo/PROJ/issues/1525</span></span></span>
<span class="r-in"><span><span class="va">pv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/CallExternal.html" class="external-link">.Call</a></span><span class="op">(</span><span class="st">"PROJ4VersionInfo"</span>, PACKAGE<span class="op">=</span><span class="st">"rgdal"</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">pv</span> <span class="op">&gt;=</span> <span class="fl">600</span> <span class="op">&amp;&amp;</span> <span class="va">pv</span> <span class="op">&lt;</span> <span class="fl">620</span><span class="op">)</span> <span class="va">broke_proj</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">broke_proj</span><span class="op">)</span> <span class="op">{</span> </span></span>
<span class="r-in"><span><span class="va">crds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9.05</span>, <span class="fl">48.52</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spPoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPoints</a></span><span class="op">(</span>coords<span class="op">=</span><span class="va">crds</span>,</span></span>
<span class="r-in"><span> proj4string<span class="op">=</span><span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +ellps=sphere +no_defs"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ob_tran_def</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"+proj=ob_tran +o_proj=longlat"</span>,</span></span>
<span class="r-in"><span> <span class="st">"+o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere +no_defs"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tg</span> <span class="op">&lt;-</span> <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="va">ob_tran_def</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># proj4string not propagated in GDAL 3.0.0</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">spPoint</span>, <span class="va">tg</span>, use_ob_tran<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SpatialPoints:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      coords.x1 coords.x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -5.917698  -1.87195</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinate Reference System (CRS) arguments: +proj=ob_tran</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +o_proj=longlat +o_lon_p=-162 +o_lat_p=39.25 +lon_0=180 +ellps=sphere</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +no_defs </span>
<span class="r-in"><span><span class="co">#should be (-5.917698, -1.87195)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">broke_proj</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">spTransform</span><span class="op">(</span><span class="va">a</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +ellps=sphere +no_defs"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> use_ob_tran<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SpatialPoints:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      coords.x1 coords.x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]      9.05     48.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinate Reference System (CRS) arguments: +proj=longlat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +ellps=sphere +no_defs </span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">broke_proj</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">spTransform</span><span class="op">(</span><span class="va">a</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"+proj=tmerc +lat_0=0 +lon_0=9 +k=1"</span>,</span></span>
<span class="r-in"><span><span class="st">"+x_0=3500000 +y_0=0 +ellps=bessel +units=m +no_defs"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> use_ob_tran<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in spTransform(a, CRS(paste("+proj=tmerc +lat_0=0 +lon_0=9 +k=1",  : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Use ob_tran to or from unprojected objects only</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">broke_proj</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">spTransform</span><span class="op">(</span><span class="va">spPoint</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"+proj=tmerc +lat_0=0 +lon_0=9 +k=1"</span>,</span></span>
<span class="r-in"><span><span class="st">"+x_0=3500000 +y_0=0 +ellps=bessel +units=m +no_defs"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SpatialPoints:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      coords.x1 coords.x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   3503693   5375702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinate Reference System (CRS) arguments: +proj=tmerc +lat_0=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +ellps=bessel +units=m +no_defs </span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">broke_proj</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">spTransform</span><span class="op">(</span><span class="fu">spTransform</span><span class="op">(</span><span class="va">a</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +ellps=sphere +no_defs"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> use_ob_tran<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"+proj=tmerc +lat_0=0 +lon_0=9 +k=1"</span>,</span></span>
<span class="r-in"><span><span class="st">"+x_0=3500000 +y_0=0 +ellps=bessel +units=m +no_defs"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SpatialPoints:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      coords.x1 coords.x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   3503693   5375702</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coordinate Reference System (CRS) arguments: +proj=tmerc +lat_0=0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> +lon_0=9 +k=1 +x_0=3500000 +y_0=0 +ellps=bessel +units=m +no_defs </span>
<span class="r-in"><span><span class="va">crds1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">51</span>, <span class="fl">8</span>, <span class="fl">52</span>, <span class="fl">9</span>, <span class="fl">52</span>, <span class="fl">10</span>, <span class="fl">51</span>, <span class="fl">7</span>, <span class="fl">51</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>byrow<span class="op">=</span><span class="cn">TRUE</span>, dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">crds2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">48</span>, <span class="fl">9</span>, <span class="fl">49</span>, <span class="fl">11</span>, <span class="fl">49</span>, <span class="fl">9</span>, <span class="fl">48</span>, <span class="fl">8</span>, <span class="fl">48</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>byrow<span class="op">=</span><span class="cn">TRUE</span>, dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">crds3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">47</span>, <span class="fl">6</span>, <span class="fl">55</span>, <span class="fl">15</span>, <span class="fl">55</span>, <span class="fl">15</span>, <span class="fl">47</span>, <span class="fl">6</span>, <span class="fl">47</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>byrow<span class="op">=</span><span class="cn">TRUE</span>, dimnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">spLines</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialLines.html" class="external-link">SpatialLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/Line.html" class="external-link">Lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/Line.html" class="external-link">Line</a></span><span class="op">(</span><span class="va">crds1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/sp/man/Line.html" class="external-link">Line</a></span><span class="op">(</span><span class="va">crds2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/Line.html" class="external-link">Line</a></span><span class="op">(</span><span class="va">crds3</span><span class="op">)</span><span class="op">)</span>, ID<span class="op">=</span><span class="st">"a"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/methods/slot.html" class="external-link">slot</a></span><span class="op">(</span><span class="va">spLines</span>, <span class="st">"proj4string"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +ellps=sphere +no_defs"</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/bbox.html" class="external-link">bbox</a></span><span class="op">(</span><span class="va">spLines</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   min max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x   6  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  47  55</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">broke_proj</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">spLines_tr</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">spLines</span>, <span class="va">tg</span>, use_ob_tran<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/bbox.html" class="external-link">bbox</a></span><span class="op">(</span><span class="va">spLines_tr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         min       max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x -8.163685 -1.725025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y -3.708442  4.807871</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">broke_proj</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/bbox.html" class="external-link">bbox</a></span><span class="op">(</span><span class="fu">spTransform</span><span class="op">(</span><span class="va">spLines_tr</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +ellps=sphere"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> use_ob_tran<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   min max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x   6  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  47  55</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">broke_proj</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">spPolygons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html" class="external-link">SpatialPolygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html" class="external-link">Polygons</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html" class="external-link">Polygon</a></span><span class="op">(</span><span class="va">crds1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html" class="external-link">Polygon</a></span><span class="op">(</span><span class="va">crds2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPolygons.html" class="external-link">Polygon</a></span><span class="op">(</span><span class="va">crds3</span><span class="op">)</span><span class="op">)</span>, ID<span class="op">=</span><span class="st">"a"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/methods/slot.html" class="external-link">slot</a></span><span class="op">(</span><span class="va">spPolygons</span>, <span class="st">"proj4string"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +ellps=sphere +no_defs"</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/bbox.html" class="external-link">bbox</a></span><span class="op">(</span><span class="va">spPolygons</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   min max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x   6  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  47  55</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">broke_proj</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">spPolygons_tr</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">spPolygons</span>, <span class="va">tg</span>, use_ob_tran<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/bbox.html" class="external-link">bbox</a></span><span class="op">(</span><span class="va">spPolygons_tr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         min       max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x -8.163685 -1.725025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y -3.708442  4.807871</span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">broke_proj</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/bbox.html" class="external-link">bbox</a></span><span class="op">(</span><span class="fu">spTransform</span><span class="op">(</span><span class="va">spPolygons_tr</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +ellps=sphere"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> use_ob_tran<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   min max</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x   6  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> y  47  55</span>
<span class="r-in"><span><span class="co"># added after posting by Martin Ivanov</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">nor2k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nor2k</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nor2kNGO</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">nor2k</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:4273"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">nor2kNGO</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">nor2k</span><span class="op">)</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">nor2kNGO</span><span class="op">)</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># added after posting by Don MacQueen </span></span></span>
<span class="r-in"><span><span class="va">crds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">121.524764291826</span>, <span class="op">-</span><span class="fl">121.523480804667</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">37.6600366036405</span>, <span class="fl">37.6543604613483</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1703671.30566227</span>, <span class="fl">1704020.20113366</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">424014.398045834</span>, <span class="fl">421943.708664294</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">crs.step1.cf</span> <span class="op">&lt;-</span> <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"+proj=lcc +lat_1=38.43333333333333"</span>,</span></span>
<span class="r-in"><span> <span class="st">"+lat_2=37.06666666666667 +lat_0=36.5 +lon_0=-120.5"</span>,</span></span>
<span class="r-in"><span> <span class="st">"+x_0=2000000.0 +y_0=500000.0 +ellps=GRS80 +units=us-ft +no_defs"</span>,</span></span>
<span class="r-in"><span> <span class="st">"+towgs84=-0.991,1.9072,0.5129,0.025789908,0.0096501,0.0116599,0.0"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">locs.step1.cf</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPoints</a></span><span class="op">(</span><span class="va">crds</span>,</span></span>
<span class="r-in"><span> proj4string<span class="op">=</span><span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+proj=longlat +datum=WGS84"</span><span class="op">)</span><span class="op">)</span>, <span class="va">crs.step1.cf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/is.projected.html" class="external-link">proj4string</a></span><span class="op">(</span><span class="va">locs.step1.cf</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"+proj=lcc"</span>,</span></span>
<span class="r-in"><span><span class="st">"+lat_1=38.43333333333333 +lat_2=37.06666666666667 +lat_0=36.5"</span>,</span></span>
<span class="r-in"><span><span class="st">"+lon_0=-120.5 +x_0=2000000.0 +y_0=500000.0 +ellps=GRS80 +units=us-ft"</span>,</span></span>
<span class="r-in"><span><span class="st">"+no_defs +nadgrids=@null"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">locs.step2.cfb</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">locs.step1.cf</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:26743"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">locs.step2.cfb</span><span class="op">)</span> <span class="op">-</span> <span class="va">ref</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">locs.step2.cfb</span><span class="op">)</span><span class="op">)</span>, <span class="va">ref</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># new_proj_and_gdal()</span></span></span>
<span class="r-in"><span><span class="va">run</span> <span class="op">&lt;-</span> <span class="fu"><a href="projInfo.html">new_proj_and_gdal</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">run</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># Test for UTM == TMERC (&lt;= 4.9.2) or UTM == ETMERC (&gt; 4.9.2)</span></span></span>
<span class="r-in"><span><span class="va">nhh</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.304234</span>, <span class="fl">60.422311</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> proj4string<span class="op">=</span><span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span>SRS_string<span class="op">=</span><span class="st">"OGC:CRS84"</span><span class="op">)</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>office<span class="op">=</span><span class="st">"RSB"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nhh_utm_32N_P4</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">nhh</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:3044"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nhh_tmerc_P4</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">nhh</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"+proj=tmerc +k=0.9996"</span>,</span></span>
<span class="r-in"><span> <span class="st">"+lon_0=9 +x_0=500000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">nhh_etmerc_P4</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">nhh</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"+proj=etmerc +k=0.9996"</span>,</span></span>
<span class="r-in"><span> <span class="st">"+lon_0=9 +x_0=500000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">nhh_utm_32N_P4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">nhh_tmerc_P4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> tolerance<span class="op">=</span><span class="fl">1e-9</span>, scale<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># UTM == TMERC: PROJ4 &lt;=4.9.2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">nhh_utm_32N_P4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">nhh_etmerc_P4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> tolerance<span class="op">=</span><span class="fl">1e-9</span>, scale<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># UTM == ETMERC: PROJ4 &gt; 4.9.2</span></span></span>
<span class="r-in"><span><span class="va">unis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/sp/man/SpatialPoints.html" class="external-link">SpatialPointsDataFrame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15.653453</span>, <span class="fl">78.222504</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> proj4string<span class="op">=</span><span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span>SRS_string<span class="op">=</span><span class="st">"OGC:CRS84"</span><span class="op">)</span>, data<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>office<span class="op">=</span><span class="st">"UNIS"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">unis_utm_33N_P4</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">unis</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="st">"+init=epsg:3045"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">unis_tmerc_P4</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">unis</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"+proj=tmerc +k=0.9996 +lon_0=15"</span>,</span></span>
<span class="r-in"><span> <span class="st">"+x_0=500000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">unis_etmerc_P4</span> <span class="op">&lt;-</span> <span class="fu">spTransform</span><span class="op">(</span><span class="va">unis</span>, <span class="fu"><a href="CRS-class.html">CRS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"+proj=etmerc +k=0.9996"</span>,</span></span>
<span class="r-in"><span> <span class="st">"+lon_0=15 +x_0=500000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">unis_utm_33N_P4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">unis_tmerc_P4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> tolerance<span class="op">=</span><span class="fl">1e-9</span>, scale<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># UTM == TMERC: PROJ4 &lt;=4.9.2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">unis_utm_33N_P4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/sp/man/coordinates.html" class="external-link">coordinates</a></span><span class="op">(</span><span class="va">unis_etmerc_P4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span> tolerance<span class="op">=</span><span class="fl">1e-9</span>, scale<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># UTM == ETMERC: PROJ4 &gt; 4.9.2</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Roger Bivand, Tim Keitt, Barry Rowlingson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

